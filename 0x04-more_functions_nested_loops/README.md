More nest loops amd fumctions
